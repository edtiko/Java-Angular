<style>
    .username.ng-valid {
        background-color: lightgreen;
    }
    .username.ng-dirty.ng-invalid-required {
        background-color: red;
    }
    .username.ng-dirty.ng-invalid-minlength {
        background-color: yellow;
    }

    .email.ng-valid {
        background-color: lightgreen;
    }
    .email.ng-dirty.ng-invalid-required {
        background-color: red;
    }
    .email.ng-dirty.ng-invalid-email {
        background-color: yellow;
    }

</style>


<div class="generic-container" ng-show="appReady" id="user-container">
    <div class="panel panel-default">
        <div class="panel-heading"><span class="lead">Datos Personales</span></div>
        <div class="panel-body">
            <div class="container-fluid">
                <form  name="myFormUser" class="form-horizontal">
                    <input type="hidden" ng-model="user.userId" />
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="uname">Nombres:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.name" id="uname" class="form-control input-sm" placeholder="Ingrese su Nombre" required ng-minlength="3"/>
                                <div class="has-error" ng-show="myFormUser.$dirty">
                                    <span ng-show="myFormUser.uname.$error.required">Este es un campo requerido</span>
                                    <span ng-show="myFormUser.uname.$error.minlength">El tama&ntilde;o minimo requerido es 3</span>
                                    <span ng-show="myFormUser.uname.$invalid">Este campo es invalido</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="lname">Apellidos:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.lastName" id="lname" class="form-control input-sm" placeholder="Ingrese su Apellido" required ng-minlength="3"/>
                                <div class="has-error" ng-show="myFormUser.$dirty">
                                    <span ng-show="myFormUser.lname.$error.required">Este es un campo requerido</span>
                                    <span ng-show="myFormUser.lname.$error.minlength">El tama&ntilde;o minimo requerido es 3</span>
                                    <span ng-show="myFormUser.lname.$invalid">Este campo es invalido</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="email">Correo Electr&oacute;nico:</label>
                            <div class="col-md-7">
                                <input type="email" ng-model="user.email" id="email" class="email form-control input-sm" placeholder="Ingrese su Correo" required/>
                                <div class="has-error" ng-show="myFormUser.$dirty">
                                    <span ng-show="myFormUser.email.$error.required">This is a required field</span>
                                    <span ng-show="myFormUser.email.$invalid">This field is invalid </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="sex">Sexo:</label>
                            <div class="col-md-7">
                                <select id="sex" ng-model="user.sex" ng-options="k as v for (k,v) in sexOptions" class="form-control"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="phone">Tel&eacute;fono fijo:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.phone" id="phone" class="form-control input-sm" placeholder="Ingrese su Tel&eacute;fono"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="cellphone">Celular:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.cellphone" id="cellphone" class="form-control input-sm" placeholder="Ingrese su Celular"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="country">Pa&iacute;s:</label>
                            <div class="col-md-7">
                                <select ng-init="" placeholder="Ingrese su País" id="country" ng-model="user.countryId" ng-options="country.countryId as country.name for country in countries" ng-change="getStatesByCountry(user.countryId)" class="form-control"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="state">Estado:</label>
                            <div class="col-md-7">
                                <select id="state"  ng-model="user.federalStateId" ng-options="state.federalStateId as state.name for state in states" ng-change="getCitiesByState(user.federalStateId)" class="form-control"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="city">Ciudad:</label>
                            <div class="col-md-7">
                                <select id="city" ng-model="user.cityId" ng-options="city.cityId as city.name for city in cities" ng-change="" class="form-control"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="address">Direcci&oacute;n:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.address" id="address" class="form-control input-sm" placeholder="Ingrese su Direcci&oacute;n"/>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="postalCode">C&oacute;digo Postal:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.postalCode" id="postalCode" class="form-control input-sm" placeholder="Ingrese su C&oacute;digo Postal"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="birthDate">Fecha de Nacimiento:</label>
                            <div class="col-md-7">
                                <p class="input-group">
                                    <input type="text" id="birthDate" class="form-control" uib-datepicker-popup="{{format}}" ng-model="dt" is-open="popup.opened" placeholder="Ingrese su Fecha de Nacimiento" datepicker-options="dateOptions" ng-required="true" close-text="Close" maxlength="10"/>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open()"><i class="glyphicon glyphicon-calendar"></i></button>
                                    </span>
                                </p>

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="postalCode">P&aacute;gina de Facebook:</label>
                            <div class="col-md-7">
                                <input type="text" ng-model="user.facebookPage" id="postalCode" class="form-control input-sm" placeholder="Ingrese su P&aacute;gina de Facebook"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="col-md-2 control-lable" for="picture">Foto de Perfil:</label>
                            <div class="col-md-7">
                                <input type="file" file-model="myFile" ng-model="user.profile_photo" id="picture" class="form-control input-sm" placeholder="Seleccione una foto"/>
                                <button type="button" class="btn btn-default btn-sm" ng-click="uploadFile()">subir foto</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group col-md-12">
                        <div class="form-actions">
                            <button type="button" ng-click="submitUser()"  class="btn btn-primary btn-sm" ng-disabled="myFormUser.$invalid">Guardar</button>
                            <button type="button" ng-click="resetUser()" class="btn btn-warning btn-sm" ng-disabled="myFormUser.$pristine">Limpiar</button>
                        </div>
                    </div>

                </form>
            </div>
            <div class="ontop">
                <img data-ng-src="{{dataImage}}"  data-err-src="static/img/profile-default.png" style="height: 200px; width: 200px;"/>
            </div>
        </div>
    </div>
</div>
<hr>
<div id="userProfileDiv">
    <div class="panel panel-default">
        <div class="panel-heading"><span class="lead">Datos Deportivos</span></div>
        <div class="panel-body">  
            <div class="formcontainer" > 

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">&iquest;Tienes pulsometro? </label>
                        <div class="col-md-3">
                            <input type="radio" name="pulsometro" ng-model="userProfile.indPulsometer" ng-value="'1'"> Si
                            <input type="radio" name="pulsometro" ng-model="userProfile.indPulsometer" ng-value="'0'"> No
                        </div>
                        <div ng-show="userProfile.indPulsometer == 1">
                            <label class="col-md-2 control-lable">&iquest;Cu&aacute;l?</label>
                            <div class="col-md-3">
                                <select class="form-control" style=" display: inline" ng-model="userProfile.pulsometer"
                                        ng-options="p.sportEquipmentId as p.brand for p in pulsometers">
                                    <option> Seleccione </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">&iquest;Tienes potenciometro?</label>
                        <div class=" col-md-3">
                            <input  type="radio" name="potenciometro" ng-model="userProfile.indPower" ng-value="'1'"> Si
                            <input type="radio" name="potenciometro" ng-model="userProfile.indPower" ng-value="'0'"> No
                        </div>
                        <div ng-show="userProfile.indPower == 1">
                            <label class="col-md-2 control-lable">&iquest;Cu&aacute;l?</label>
                            <div class=" col-md-3">
                                <select class="form-control" style=" display: inline" ng-model="userProfile.potentiometer"
                                        ng-options="p.sportEquipmentId as p.brand for p in potentiometers">
                                    <option> Seleccione </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">&iquest;Tienes bicicleta? </label>
                        <div class=" col-md-3">
                            <input id="bicicleta" type="radio" name="bicicleta" ng-model="indBike" ng-value="'1'"> Si
                            <input type="radio" name="bicicleta"  ng-model="indBike" ng-value="'0'"> No
                        </div>
                        <div  ng-show="indBike == 1">
                            <label class="col-md-2 control-lable">&iquest;Cu&aacute;l?</label>
                            <div class=" col-md-3">
                                <select class="form-control" style=" display: inline" ng-model="userProfile.bike"
                                        ng-options="b.brand for b in bikes track by b.brand">
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Disponibilidad</label>
                        <div class=" col-md-3">
                            <div ng-repeat="d in userProfile.availability">
                                <label>{{d.day}}</label>
                                <input type="checkbox" ng-model="availability[d]" value="{{d}}" ng-checked="{{d.checked}}"
                                       ng-checked="getAvailabilityResponse($parent.$index, d)"
                                       ng-click="setAvailabilityResponse($parent.$index, $index, d)"
                                       
                                       >
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Objetivo</label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.objective"
                                    ng-options="o.objectiveId as o.name for o in objectives">
                                <option> Seleccione </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">&iquest;Qu&eacute; tipo de zapatilla usas?</label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.shoes"
                                    ng-options="shoe.sportEquipmentId as shoe.brand for shoe in shoes">
                                <option> Seleccione </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Disciplina Deportiva</label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.discipline"
                                    ng-options="disc.disciplineId as disc.name for disc in disciplines" ng-change="getModalitiesByDisciplineId(userProfile.discipline)">
                                <option selected="selected"> Seleccione </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Modalidad</label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.modality"
                                    ng-options="m.modalityId as m.name for m in modalities">
                                <option> Seleccione </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Edad Deportiva</label>
                        <div class=" col-md-3">
                            <input type="text" class="form-control input-sm" style=" display: inline" ng-model="userProfile.ageSport">
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Ppm</label>
                        <div class=" col-md-3">
                            <input type="text" class="form-control input-sm" style=" display: inline" ng-model="userProfile.ppm">
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Potencia</label>
                        <div class=" col-md-3">
                            <input type="text" class="form-control input-sm" style=" display: inline" ng-model="userProfile.power">
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">&iquest;Practicas otros deportes?</label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.sport"
                                    ng-options="s.sportId as s.name for s in sports">
                                <option> Seleccione </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Logros Deportivos</label>
                        <div class=" col-md-3">
                            <textarea class="ng-invalid form-control" ng-model="userProfile.sportsAchievements" 
                                      style=" display: inline; resize: none">
                            </textarea>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Sistema de medici&oacute;n </label>
                        <div class=" col-md-3">
                            <select class="form-control" style=" display: inline" ng-model="userProfile.indMetricSys">
                                <option value="" hidden></option>
                                <option value="-1"> Seleccione </option>
                                <option ng-repeat="metricSys in metricSystems" value="{{metricSys.id}}">{{metricSys.name}}</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row"> 
                    <div class="form-group col-md-12">
                        <label class="col-md-2 control-lable">Acerca de m&iacute;</label>
                        <div class=" col-md-3">
                            <textarea class="form-control" style=" display: inline;resize: none" ng-model="userProfile.aboutMe"></textarea>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" ng-click="createOrMergeUserProfile(userProfile)"> Guardar </button>
                <button class="btn btn-primary" ng-click="resetProfile()" >Limpiar</button>
                <button class="btn btn-primary" ng-click="generatePlan(userProfile)"> Generar </button>
            </div>
        </div>
    </div>
</div>
<hr>
<div id="surveyDiv">
    <form  class="form-horizontal" name="myFormSurvey">
        <div ng-repeat="category in categories">
            <div class="panel panel-default">
                <div class="panel-heading"><span class="lead">{{category.name}}</span></div>
                <div class="panel-body">
                    <div class="container-fluid">
                        <div ng-repeat="question in survey" ng-if="question.questionnaireCategoryId.questionnaireCategoryId === category.questionnaireCategoryId">
                            <div class="form-group">

                                <label>{{$index + 1}}. {{question.questionId.name}}</label>
                                <div class="row">
                                    <div class="col-md-7">
                                        <div ng-switch="question.questionId.dataType">
                                            <div ng-switch-when="text">
                                                <input type="text"  ng-required="question.questionId.questionType=='M'" name="{{question.questionId.name}}" ng-model="survey[$index].questionnaireResponseList[0].response" ng-blur="setValue($index)" class="form-control input-sm" >
                                            </div>
                                            <div ng-switch-when="number">
                                                <input type="number" string-to-number ng-required="question.questionId.questionType=='M'" ng-model="survey[$index].questionnaireResponseList[0].response" ng-blur="setValue($index)" class="form-control input-sm" >
                                            </div>
                                            <div ng-switch-when="select" >
                                                <select ng-required="question.questionId.questionType=='M'" class="form-control input-sm" ng-options="q.questionOptionId as q.name for q in question.questionId.questionOptionList" ng-change="setValue($index)" data-ng-model="survey[$index].questionnaireResponseList[0].questionOptionId">
                                                    <option value="">Seleccione una opci&oacute;n..</option>
                                                </select>
                                            </div>
                                            <div ng-switch-when="checkbox">
                                                <div ng-repeat="questionOption in question.questionId.questionOptionList">
                                                    <div class="checkbox">
                                                        <label><input type="checkbox" 
                                                                      ng-model="survey[$parentIndex].questionnaireResponseList[$index].checked"
                                                                      ng-checked="getResponse($parent.$index, questionOption.questionOptionId)"
                                                                      ng-click="setResponse($parent.$index, $index, questionOption.questionOptionId)"
                                                                      value="{{questionOption.questionOptionId}}"
                                                                      >{{questionOption.name}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div ng-switch-when="radio">
                                                <div ng-repeat="questionOption in question.questionId.questionOptionList">
                                                    <div class="radio">
                                                        <label><input ng-required="question.questionId.questionType=='M'" type="radio" ng-click="setValue($parent.$index)" ng-model="survey[$parent.$index].questionnaireResponseList[0].questionOptionId" name="option{{question.questionId.questionId}}" value="{{questionOption.questionOptionId}}">{{questionOption.name}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div role="alert" class="has-error" ng-show="myFormSurvey.$dirty">
                                            <span ng-show="myFormSurvey[question.questionId.name].$error.required">Esta pregunta es obligatoria</span>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- categories -->
        <div class="form-group row">
            <div class="form-actions col-xs-12">
                <button ng-click="submitSurvey()" type="button" class="btn btn-primary btn-sm" ng-disabled="myFormSurvey.$invalid">Guardar</button>
                <button type="button" ng-click="resetSurvey()" class="btn btn-warning btn-sm">Limpiar</button>
            </div>
        </div>
    </form>
    
</div>

